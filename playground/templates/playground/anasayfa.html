{% extends "playground/base.html" %}
{% load static %}

{% block title %}Ana Sayfa - Pera Kids{% endblock %}

{% block content %}
<div class="anasayfa-bg">
  <!-- Playful animated shapes for extra color -->
  <div class="anasayfa-shape shape1"></div>
  <div class="anasayfa-shape shape2"></div>
  <div class="anasayfa-shape shape3"></div>
  <div class="anasayfa-shape shape4"></div>
  <div class="anasayfa-shape shape5"></div>

  <div class="container">
      <h1 class="page-title">Mağazamızdaki Ürünler</h1>

      {% if urunler_listesi %}
          <div class="urun-listesi">
              {% for product in urunler_listesi %}
                  <div class="urun-karti">
                      <a href="{% url 'playground:urun_detay' product.slug %}">
                          <div class="urun-resim-konteyner">
                              {% with main_image=product.get_main_image %}
                                  <img id="product-image-{{ product.id }}" src="{% if main_image %}{{ main_image.image.url }}{% else %}{% static 'playground/img/placeholder.png' %}{% endif %}" alt="{{ product.name }}">
                              {% endwith %}
                          </div>
                      </a>
                      <div class="urun-karti-icerik">
                          <h2>{{ product.name }}</h2>
                          <ul class="renk-secenekleri">
                              {% for color in product.colors.all %}
                                  {% with color_image=color.images.first %}
                                      {% if color_image %}
                                          <li class="renk-kutusu {% if color.is_main_color %}active{% endif %}"
                                              style="background-color: {{ color.color_name|lower }};"
                                              title="{{ color.color_name }}"
                                              data-image-url="{{ color_image.image.url }}"
                                              data-product-id="{{ product.id }}">
                                          </li>
                                      {% endif %}
                                  {% endwith %}
                              {% endfor %}
                          </ul>
                          {% with main_color=product.get_main_color %}
                              {% if main_color %}
                                  <div class="urun-fiyati">{{ main_color.price }} TL</div>
                              {% endif %}
                          {% endwith %}
                          <a href="{% url 'playground:urun_detay' product.slug %}" class="detay-link">Detayları Gör</a>
                      </div>
                  </div>
              {% endfor %}
          </div>
      {% else %}
          <p style="text-align:center;">Gösterilecek ürün bulunamadı.</p>
      {% endif %}
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const colorSwatches = document.querySelectorAll('.renk-kutusu');
    colorSwatches.forEach(swatch => {
        swatch.addEventListener('click', function(event) {
            event.preventDefault();
            event.stopPropagation();
            const productId = this.dataset.productId;
            const newImageUrl = this.dataset.imageUrl;
            const productImage = document.getElementById(`product-image-${productId}`);
            if (productImage && newImageUrl) {
                productImage.src = newImageUrl;
            }
            const parentCard = this.closest('.urun-karti');
            parentCard.querySelectorAll('.renk-kutusu').forEach(s => s.classList.remove('active'));
            this.classList.add('active');
        });
    });
});
</script>
{% endblock %}

{% block extra_css %}
<style>
.anasayfa-bg {
  position: relative;
  min-height: 100vh;
  width: 100vw;
  overflow: hidden;
  background: linear-gradient(120deg, #ff6f91 0%, #ff9671 30%, #ffc75f 60%, #a1c4fd 100%);
  animation: bgMove 18s ease-in-out infinite alternate;
}
.anasayfa-shape {
  position: absolute;
  border-radius: 50%;
  opacity: 0.22;
  filter: blur(2px);
  z-index: 1;
  animation: floatShape 12s infinite ease-in-out alternate;
}
.anasayfa-shape.shape1 { background: #ff6f91; width: 220px; height: 220px; left: 4vw; top: 7vh; animation-delay: 0s; }
.anasayfa-shape.shape2 { background: #ffc75f; width: 140px; height: 140px; right: 10vw; top: 20vh; animation-delay: 2s; }
.anasayfa-shape.shape3 { background: #a1c4fd; width: 180px; height: 180px; left: 18vw; bottom: 8vh; animation-delay: 4s; }
.anasayfa-shape.shape4 { background: #ff9671; width: 110px; height: 110px; right: 20vw; bottom: 10vh; animation-delay: 1s; }
.anasayfa-shape.shape5 { background: #ff6f91; width: 80px; height: 80px; left: 55vw; top: 65vh; animation-delay: 3s; }
@media (max-width: 900px) {
  .anasayfa-shape.shape1 { width: 120px; height: 120px; }
  .anasayfa-shape.shape2 { width: 80px; height: 80px; }
  .anasayfa-shape.shape3 { width: 100px; height: 100px; }
  .anasayfa-shape.shape4 { width: 60px; height: 60px; }
  .anasayfa-shape.shape5 { width: 40px; height: 40px; }
}
.anasayfa-bg .container {
  position: relative;
  z-index: 2;
  background: rgba(255,255,255,0.93);
  border-radius: 22px;
  box-shadow: 0 4px 32px 0 #ffc75f33;
  padding-top: 32px;
  padding-bottom: 32px;
}
.anasayfa-bg .urun-listesi {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 20px;
  list-style: none;
  padding: 0;
}
@media (max-width: 900px) {
  .anasayfa-bg .urun-listesi { grid-template-columns: repeat(2, 1fr); }
}
@media (max-width: 600px) {
  .anasayfa-bg .urun-listesi { grid-template-columns: 1fr; }
}
</style>
{% endblock %}